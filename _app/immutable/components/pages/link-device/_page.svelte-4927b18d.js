import{S as te,i as se,s as ne,k as _,a as D,q as I,l as h,c as N,m as b,r as A,h as d,n as u,b as C,D as l,H as ae,C as G,a5 as le,u as de,e as Q,t as T,d as fe,f as V,G as ue,g as me,x as oe,y as ie,z as re,A as ce}from"../../../chunks/index-5bd3dcd0.js";import{g as B}from"../../../chunks/nav-1ca5ec09.js";import{p as pe}from"../../../chunks/stores-4fd3c68b.js";import{a as S}from"../../../chunks/notifications-4ae7a520.js";import{a as _e}from"../../../chunks/linking-ec5764b4.js";import{l as he}from"../../../chunks/account-a239d173.js";import{F as ve}from"../../../chunks/FilesystemActivity-903598e6.js";import{c as be}from"../../../chunks/index-3b3973a3.js";import{a as X}from"../../../chunks/app-info-b761063d.js";import{e as Z}from"../../../chunks/utils-a870ce58.js";function ee(r){let t,o,e,s;return{c(){t=_("span"),o=I(r[0]),this.h()},l(n){t=h(n,"SPAN",{class:!0});var i=b(t);o=A(i,r[0]),i.forEach(d),this.h()},h(){u(t,"class","btn text-base-100 hover:text-base-100 bg-base-content hover:bg-base-content border-0 btn-lg rounded-full text-deviceCode tracking-[.18em] w-3/4 cursor-pointer font-mono font-light")},m(n,i){C(n,t,i),l(t,o),e||(s=ae(t,"click",r[2]),e=!0)},p(n,i){i&1&&de(o,n[0])},d(n){n&&d(t),e=!1,s()}}}function ge(r){let t,o,e,s,n,i,v,p,k,a,c,g,L,q,w,P,j,R,U,$,F,H,M,f=r[0]&&ee(r);return{c(){t=_("input"),o=D(),e=_("div"),s=_("div"),n=_("div"),i=_("h3"),v=I("Connect to "),p=I(X),k=D(),a=_("div"),f&&f.c(),c=D(),g=_("span"),L=I("Enter this code on your connected device."),q=D(),w=_("div"),P=_("span"),j=I(`
          Waiting for a response...`),R=D(),U=_("div"),$=_("button"),F=I("Cancel Request"),this.h()},l(m){t=h(m,"INPUT",{type:!0,id:!0,class:!0}),o=N(m),e=h(m,"DIV",{class:!0});var y=b(e);s=h(y,"DIV",{class:!0});var O=b(s);n=h(O,"DIV",{class:!0});var E=b(n);i=h(E,"H3",{class:!0});var W=b(i);v=A(W,"Connect to "),p=A(W,X),W.forEach(d),k=N(E),a=h(E,"DIV",{class:!0});var x=b(a);f&&f.l(x),c=N(x),g=h(x,"SPAN",{class:!0});var Y=b(g);L=A(Y,"Enter this code on your connected device."),Y.forEach(d),q=N(x),w=h(x,"DIV",{class:!0});var z=b(w);P=h(z,"SPAN",{class:!0}),b(P).forEach(d),j=A(z,`
          Waiting for a response...`),z.forEach(d),x.forEach(d),R=N(E),U=h(E,"DIV",{});var J=b(U);$=h(J,"BUTTON",{class:!0});var K=b($);F=A(K,"Cancel Request"),K.forEach(d),J.forEach(d),E.forEach(d),O.forEach(d),y.forEach(d),this.h()},h(){u(t,"type","checkbox"),u(t,"id","my-modal-5"),t.checked=!0,u(t,"class","modal-toggle"),u(i,"class","text-base"),u(g,"class","text-sm text-left"),u(P,"class","rounded-lg border-t-2 border-l-2 border-slate-600 dark:border-slate-50 w-4 h-4 block animate-spin"),u(w,"class","grid grid-flow-col auto-cols-max gap-4 justify-center items-center text-slate-500"),u(a,"class","grid grid-flow-row auto-rows-max gap-4 justify-items-center"),u($,"class","btn btn-outline text-base mt-4"),u(n,"class","grid grid-flow-row auto-rows-max gap-7"),u(s,"class","modal-box w-narrowModal relative text-center dark:border-slate-600 dark:border"),u(e,"class","modal")},m(m,y){C(m,t,y),C(m,o,y),C(m,e,y),l(e,s),l(s,n),l(n,i),l(i,v),l(i,p),l(n,k),l(n,a),f&&f.m(a,null),l(a,c),l(a,g),l(g,L),l(a,q),l(a,w),l(w,P),l(w,j),l(n,R),l(n,U),l(U,$),l($,F),H||(M=ae($,"click",r[1]),H=!0)},p(m,[y]){m[0]?f?f.p(m,y):(f=ee(m),f.c(),f.m(a,c)):f&&(f.d(1),f=null)},i:G,o:G,d(m){m&&d(t),m&&d(o),m&&d(e),f&&f.d(),H=!1,M()}}}function ke(r,t,o){let{pin:e}=t;const s=le(),n=()=>{s("cancel")},i=async()=>{await be(e),S("Copied to clipboard","success")};return r.$$set=v=>{"pin"in v&&o(0,e=v.pin)},[e,n,i]}class ye extends te{constructor(t){super(),se(this,t,ke,ge,ne,{pin:0})}}function we(r){let t,o;return t=new ve({props:{activity:"Loading"}}),{c(){oe(t.$$.fragment)},l(e){ie(t.$$.fragment,e)},m(e,s){re(t,e,s),o=!0},p:G,i(e){o||(V(t.$$.fragment,e),o=!0)},o(e){T(t.$$.fragment,e),o=!1},d(e){ce(t,e)}}}function $e(r){let t,o;return t=new ye({props:{pin:r[1]}}),t.$on("cancel",r[2]),{c(){oe(t.$$.fragment)},l(e){ie(t.$$.fragment,e)},m(e,s){re(t,e,s),o=!0},p(e,s){const n={};s&2&&(n.pin=e[1]),t.$set(n)},i(e){o||(V(t.$$.fragment,e),o=!0)},o(e){T(t.$$.fragment,e),o=!1},d(e){ce(t,e)}}}function Ce(r){let t,o,e,s,n,i;const v=[$e,we],p=[];function k(a,c){return a[0]==="link-device"?0:a[0]==="load-filesystem"?1:-1}return~(e=k(r))&&(s=p[e]=v[e](r)),{c(){t=_("input"),o=D(),s&&s.c(),n=Q(),this.h()},l(a){t=h(a,"INPUT",{type:!0,id:!0,class:!0}),o=N(a),s&&s.l(a),n=Q(),this.h()},h(){u(t,"type","checkbox"),u(t,"id","my-modal-5"),t.checked=!0,u(t,"class","modal-toggle")},m(a,c){C(a,t,c),C(a,o,c),~e&&p[e].m(a,c),C(a,n,c),i=!0},p(a,[c]){let g=e;e=k(a),e===g?~e&&p[e].p(a,c):(s&&(me(),T(p[g],1,1,()=>{p[g]=null}),fe()),~e?(s=p[e],s?s.p(a,c):(s=p[e]=v[e](a),s.c()),V(s,1),s.m(n.parentNode,n)):s=null)},i(a){i||(V(s),i=!0)},o(a){T(s),i=!1},d(a){a&&d(t),a&&d(o),~e&&p[e].d(a),a&&d(n)}}}function Ee(r,t,o){let e;ue(r,pe,c=>o(4,e=c));let s="link-device",n,i="";const v=Z(e.url,"hashedUsername"),p=decodeURIComponent(Z(e.url,"username")),k=async()=>{n=await _e(v),n.on("challenge",({pin:c})=>{o(1,i=c.join(""))}),n.on("link",async({approved:c})=>{c?(o(0,s="load-filesystem"),await he(v,p),S("You're now connected!","success"),B("/")):(S("The connection attempt was cancelled","info"),B("/"))})},a=async()=>{S("The connection attempt was cancelled","info"),await(n==null?void 0:n.cancel()),B("/")};return k(),[s,i,a]}class Le extends te{constructor(t){super(),se(this,t,Ee,Ce,ne,{})}}export{Le as default};
